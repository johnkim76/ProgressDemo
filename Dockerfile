FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHByb2dyZXNzLWRlbW8tYXBiCmRlc2NyaXB0aW9uOiBBUEIgZm9y\
IEFTQiBMYXN0IE9wZXJhdGlvbiAmIEN1c3RvbSBFcnJvciBNZXNzYWdlIERlbW8KYmluZGFibGU6\
IEZhbHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogUHJvZ3Jlc3Mg\
RGVtbyAoQVBCKQogIGxvbmdEZXNjcmlwdGlvbjogQSBzYW1wbGUgQVBCIHdoaWNoIGZhaWxzIHRv\
IGRlbW8gdGhlIEN1c3RvbSBFcnJvciBNZXNzYWdlIG1vZGUKICBwcm92aWRlckRpc3BsYXlOYW1l\
OiAiUmVkIEhhdCwgSW5jLiIKcGxhbnM6CiAgLSBuYW1lOiBsYXN0LW9wCiAgICBkZXNjcmlwdGlv\
bjogQSBzYW1wbGUgQVBCIGRlbW9uc3RyYXRpbmcgdGhlIExhc3QgT3BlcmF0aW9uIEFTQiBNb2R1\
bGUKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogQVNCIExh\
c3QgT3BlcmF0aW9uIERlbW8KICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gZGVwbG95\
cyBhIHNpbXBsZSBBUEIgdG8gc2hvdyB0aGUgQVNCJ3MgTGFzdCBPcGVyYXRpb24gTW9kdWxlIGlu\
IGFjdGlvbgogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczogW10KICAtIG5hbWU6IGN1\
c3RvbS1lcnItbXNnCiAgICBkZXNjcmlwdGlvbjogQSBzYW1wbGUgQVBCIGRlbW9uc3RyYXRpbmcg\
dGhlIEN1c3RvbSBFcnJvciBNZXNzYWdlCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAg\
ICAgZGlzcGxheU5hbWU6IEN1c3RvbSBFcnJvciBNZXNzYWdlIERlbW8KICAgICAgbG9uZ0Rlc2Ny\
aXB0aW9uOiBUaGlzIHBsYW4gZGVwbG95cyBhIHNpbXBsZSBBUEIgdG8gcHVycG9zZWZ1bGx5IGZh\
aWwgc28gdGhhdCBhIEN1c3RvbSBFcnJvciBNZXNzYWdlIGNhbiBiZSBkaXNwbGF5ZWQgaW4gdGhl\
IFdlYlVJCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOiBbXQo="

ADD playbooks /opt/apb/actions
ADD roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
